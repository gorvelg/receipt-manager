{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
    <style>
        .ticket-item {
            display: flex;
            align-items: center;
            overflow: hidden;
            position: relative;
            background: #f4f4f4;
            margin: 10px 0;
            border-radius: 5px;
            transition: transform 0.3s ease;
        }

        .ticket-content {
            flex: 1;
            padding: 15px;
            background-color: white;
            display: flex;
            justify-content: space-between;
            transition: transform 0.3s ease;
        }

        .delete-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 100px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .ticket-item.swiped .ticket-content {
            transform: translateX(-100px);
        }

        .ticket-item.swiped .delete-button {
            transform: translateX(0);
        }

    </style>

    <h1 class="text-text-800 font-medium text-3xl mb-4">Bonjour <span class="capitalize">{{ app.user.username }}</span> ! ðŸ‘‹</h1>
    <a href="{{ path('app_ticket') }}" class="fixed bottom-0 right-0 m-4">
        {% include ('components/button.html.twig') with {text: 'Ajouter un ticket', type: 'primary'} %}
    </a>
    <div class="bubble-infos rounded-md mb-4
            {{ total < 0 ? 'bg-red-100 text-red-950 border-red-200' : 'bg-teal-2 text-teal-950'}}
          ">
        <p class="p-2">
            {% if total < 0 %}
                Vous devez <span id="total" class="font-bold">{{ total|abs }} â‚¬</span>
            {% else %}
                Remboursement de <span id="total" class="font-bold">{{ total }} â‚¬</span>
            {% endif %}
        </p>
    </div>

    {% if tickets %}
        <div class="rounded-md bg-teal-2 p-2 mb-4">
            <button id="show-delete" class="btn-primary">Afficher les options de suppression</button>
        </div>
    {% endif %}

    <div class="bg-teal-2 rounded-md py-2 pl-2 mb-4">
        <h2 class="text-text-800 font-medium text-2xl mb-4">Mes tickets</h2>
        <div class="w-full text-text-800">
            {% for ticket in tickets|sort((a, b) => b.createdAt <=> a.createdAt) %}
                <div class="ticket-item" id="ticket-{{ ticket.id }}">
                    <div class="ticket-content">
                        <span class="user-tag" style="--bg-color: {{ ticket.user.color }};"></span>
                        <span>{{ ticket.title }}</span>
                        <span>{{ ticket.amount }} â‚¬</span>
                        <span>{{ ticket.createdAt|date('d/m/Y') }}</span>
                        <span>{{ ticket.user.username }}</span>
                    </div>
                    <button class="delete-button" data-ticket-id="{{ ticket.id }}">Supprimer</button>
                </div>

            {% endfor %}
        </div>
    </div>

{% endblock %}
